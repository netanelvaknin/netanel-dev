{"version":3,"sources":["pages/admin/login/Login.tsx","../node_modules/react-cookie/es6/useCookies.js"],"names":["schema","Yup","shape","email","required","password","min","max","Login","useCookies","setCookie","history","useHistory","useForm","resolver","yupResolver","register","handleSubmit","onSubmit","formState","errors","a","instance","post","response","data","token","push","console","log","name","type","dependencies","cookies","useContext","CookiesContext","Error","initialCookies","getAll","_a","useState","allCookies","setCookies","previousCookiesRef","useRef","useEffect","onChange","newCookies","oldCookies","_i","dependencies_1","length","dependency","shouldUpdate","current","addChangeListener","removeChangeListener","useMemo","set","bind","remove"],"mappings":"oPAQMA,EAASC,MAAaC,MAAM,CAChCC,MAAOF,MAAaE,QAAQC,WAC5BC,SAAUJ,MAAaK,IAAI,GAAGC,IAAI,IAAIH,aAwCzBI,UAhCf,WACE,MAA6BC,cAA7B,mBAAgBC,GAAhB,WACMC,EAAUC,cAChB,EAIIC,YAAQ,CACVC,SAAUC,YAAYf,KAJtBgB,EADF,EACEA,SACAC,EAFF,EAEEA,aAMIC,GARN,EAGEC,UAAaC,OAKD,uCAAG,iCAAAC,EAAA,6DAASlB,EAAT,EAASA,MAAOE,EAAhB,EAAgBA,SAAhB,kBAEUiB,IAASC,KAAK,eAAgB,CAAEpB,QAAOE,aAFjD,QAEPmB,EAFO,QAGAC,KAAKC,QAChBhB,EAAU,QAASc,EAASC,KAAKC,OACjCf,EAAQgB,KAAK,WALF,gDAQbC,QAAQC,IAAI,QAAZ,MARa,yDAAH,uDAYd,OACE,uBAAMX,SAAUD,EAAaC,GAA7B,UACE,cAAC,IAAD,CAAWY,KAAK,QAAQC,KAAK,QAAQf,SAAUA,IAC/C,cAAC,IAAD,CAAWe,KAAK,WAAWD,KAAK,WAAWd,SAAUA,IACrD,wBAAQe,KAAK,SAAb,wB,iCC7CN,qDAEe,SAAStB,EAAWuB,GAC/B,IAAIC,EAAUC,qBAAWC,KACzB,IAAKF,EACD,MAAM,IAAIG,MAAM,6BAEpB,IAAIC,EAAiBJ,EAAQK,SACzBC,EAAKC,mBAASH,GAAiBI,EAAaF,EAAG,GAAIG,EAAaH,EAAG,GACnEI,EAAqBC,iBAAOH,GAgBhC,OAfAI,qBAAU,WACN,SAASC,IACL,IAAIC,EAAad,EAAQK,UAerC,SAAsBN,EAAce,EAAYC,GAC5C,IAAKhB,EACD,OAAO,EAEX,IAAK,IAAIiB,EAAK,EAAGC,EAAiBlB,EAAciB,EAAKC,EAAeC,OAAQF,IAAM,CAC9E,IAAIG,EAAaF,EAAeD,GAChC,GAAIF,EAAWK,KAAgBJ,EAAWI,GACtC,OAAO,EAGf,OAAO,GAxBKC,CAAarB,GAAgB,KAAMe,EAAYJ,EAAmBW,UAClEZ,EAAWK,GAEfJ,EAAmBW,QAAUP,EAGjC,OADAd,EAAQsB,kBAAkBT,GACnB,WACHb,EAAQuB,qBAAqBV,MAElC,CAACb,IAGG,CAACQ,EAFQgB,mBAAQ,WAAc,OAAOxB,EAAQyB,IAAIC,KAAK1B,KAAa,CAACA,IACzDwB,mBAAQ,WAAc,OAAOxB,EAAQ2B,OAAOD,KAAK1B,KAAa,CAACA","file":"static/js/9.fce82e52.chunk.js","sourcesContent":["import { useForm } from \"react-hook-form\";\r\nimport * as Yup from \"yup\";\r\nimport { yupResolver } from \"@hookform/resolvers/yup\";\r\nimport { TextField } from \"../../../ui\";\r\nimport instance from \"../../../api\";\r\nimport { useCookies } from \"react-cookie\";\r\nimport { useHistory } from \"react-router-dom\";\r\n\r\nconst schema = Yup.object().shape({\r\n  email: Yup.string().email().required(),\r\n  password: Yup.string().min(2).max(25).required(),\r\n});\r\n\r\ninterface LoginValues {\r\n  email: string;\r\n  password: string;\r\n}\r\n\r\nfunction Login() {\r\n  const [cookies, setCookie] = useCookies();\r\n  const history = useHistory();\r\n  const {\r\n    register,\r\n    handleSubmit,\r\n    formState: { errors },\r\n  } = useForm({\r\n    resolver: yupResolver(schema),\r\n  });\r\n\r\n  const onSubmit = async ({ email, password }: LoginValues) => {\r\n    try {\r\n      const response = await instance.post(\"/admin/login\", { email, password });\r\n      if (response.data.token) {\r\n        setCookie(\"token\", response.data.token);\r\n        history.push(\"/admin\");\r\n      }\r\n    } catch (e) {\r\n      console.log(\"E => \", e);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <form onSubmit={handleSubmit(onSubmit)}>\r\n      <TextField name=\"email\" type=\"email\" register={register} />\r\n      <TextField type=\"password\" name=\"password\" register={register} />\r\n      <button type=\"submit\">Login</button>\r\n    </form>\r\n  );\r\n}\r\n\r\nexport default Login;\r\n","import { useContext, useEffect, useState, useRef, useMemo } from 'react';\r\nimport CookiesContext from './CookiesContext';\r\nexport default function useCookies(dependencies) {\r\n    var cookies = useContext(CookiesContext);\r\n    if (!cookies) {\r\n        throw new Error('Missing <CookiesProvider>');\r\n    }\r\n    var initialCookies = cookies.getAll();\r\n    var _a = useState(initialCookies), allCookies = _a[0], setCookies = _a[1];\r\n    var previousCookiesRef = useRef(allCookies);\r\n    useEffect(function () {\r\n        function onChange() {\r\n            var newCookies = cookies.getAll();\r\n            if (shouldUpdate(dependencies || null, newCookies, previousCookiesRef.current)) {\r\n                setCookies(newCookies);\r\n            }\r\n            previousCookiesRef.current = newCookies;\r\n        }\r\n        cookies.addChangeListener(onChange);\r\n        return function () {\r\n            cookies.removeChangeListener(onChange);\r\n        };\r\n    }, [cookies]);\r\n    var setCookie = useMemo(function () { return cookies.set.bind(cookies); }, [cookies]);\r\n    var removeCookie = useMemo(function () { return cookies.remove.bind(cookies); }, [cookies]);\r\n    return [allCookies, setCookie, removeCookie];\r\n}\r\nfunction shouldUpdate(dependencies, newCookies, oldCookies) {\r\n    if (!dependencies) {\r\n        return true;\r\n    }\r\n    for (var _i = 0, dependencies_1 = dependencies; _i < dependencies_1.length; _i++) {\r\n        var dependency = dependencies_1[_i];\r\n        if (newCookies[dependency] !== oldCookies[dependency]) {\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n}\r\n"],"sourceRoot":""}
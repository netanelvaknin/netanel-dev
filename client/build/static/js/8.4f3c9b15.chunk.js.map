{"version":3,"sources":["pages/admin/login/Login.tsx","pages/admin/add-post/AddPost.tsx","pages/admin/my-posts/MyPosts.tsx","pages/admin/Admin.tsx"],"names":["schema","Yup","shape","email","required","password","min","max","Login","useCookies","setCookie","history","useHistory","useForm","resolver","yupResolver","register","handleSubmit","onSubmit","formState","errors","a","instance","post","response","data","token","push","console","log","name","type","AddPost","cookies","useState","content","setContent","defaultValues","title","description","setValue","postId","useParams","useEffect","get","then","postToEdit","find","_id","resetFields","formValues","headers","Authorization","res","status","createdAt","moment","format","placeholder","EditorWrapper","theme","value","onChange","delta","source","editor","getHTML","modules","styled","div","toolbar","header","list","indent","direction","MyPosts","posts","setPosts","loading","setLoading","handleRemovePost","idToRemove","window","location","reload","length","map","onClick","Admin","url","useRouteMatch","style","display","pathname","flexDirection","alignItems","height","width","paddingTop","exact","path"],"mappings":"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","file":"static/js/8.4f3c9b15.chunk.js","sourcesContent":["import { useForm } from \"react-hook-form\";\r\nimport * as Yup from \"yup\";\r\nimport { yupResolver } from \"@hookform/resolvers/yup\";\r\nimport { TextField } from \"../../../ui\";\r\nimport instance from \"../../../api\";\r\nimport { useCookies } from \"react-cookie\";\r\nimport { useHistory } from \"react-router-dom\";\r\n\r\nconst schema = Yup.object().shape({\r\n  email: Yup.string().email().required(),\r\n  password: Yup.string().min(2).max(25).required(),\r\n});\r\n\r\ninterface LoginValues {\r\n  email: string;\r\n  password: string;\r\n}\r\n\r\nfunction Login() {\r\n  const [cookies, setCookie] = useCookies();\r\n  const history = useHistory();\r\n  const {\r\n    register,\r\n    handleSubmit,\r\n    formState: { errors },\r\n  } = useForm({\r\n    resolver: yupResolver(schema),\r\n  });\r\n\r\n  const onSubmit = async ({ email, password }: LoginValues) => {\r\n    try {\r\n      const response = await instance.post(\"/admin/login\", { email, password });\r\n      if (response.data.token) {\r\n        setCookie(\"token\", response.data.token);\r\n        history.push(\"/admin\");\r\n      }\r\n    } catch (e) {\r\n      console.log(\"E => \", e);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <form onSubmit={handleSubmit(onSubmit)}>\r\n      <TextField name=\"email\" type=\"email\" register={register} />\r\n      <TextField type=\"password\" name=\"password\" register={register} />\r\n      <button type=\"submit\">Login</button>\r\n    </form>\r\n  );\r\n}\r\n\r\nexport default Login;\r\n","import { useState, useEffect } from \"react\";\r\nimport ReactQuill from \"react-quill\";\r\nimport \"react-quill/dist/quill.snow.css\";\r\nimport instance from \"../../../api\";\r\nimport { useCookies } from \"react-cookie\";\r\nimport { useForm } from \"react-hook-form\";\r\nimport moment from \"moment\";\r\nimport { useParams } from \"react-router-dom\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport styled from \"styled-components/macro\";\r\n\r\nfunction AddPost() {\r\n  const history = useHistory();\r\n  const [cookies] = useCookies();\r\n  const [content, setContent] = useState<string>(\"\");\r\n  const { register, setValue, handleSubmit } = useForm({\r\n    defaultValues: {\r\n      title: \"\",\r\n      description: \"\",\r\n    },\r\n  });\r\n  const { postId } = useParams<{ postId: string }>();\r\n\r\n  useEffect(() => {\r\n    instance.get(\"/posts\").then((response) => {\r\n      if (response.data && postId) {\r\n        const postToEdit = response.data.find(\r\n          (post: any) => post._id === postId\r\n        );\r\n\r\n        setContent(postToEdit.content);\r\n        setValue(\"title\", postToEdit.title);\r\n        setValue(\"description\", postToEdit.description);\r\n      }\r\n    });\r\n  }, [postId, setValue]);\r\n\r\n  useEffect(() => {\r\n    if (!postId) {\r\n      resetFields();\r\n    }\r\n  }, [postId]);\r\n\r\n  const onChange = (content: any, delta: any, source: any, editor: any) => {\r\n    setContent(editor.getHTML());\r\n  };\r\n\r\n  const resetFields = () => {\r\n    setValue(\"title\", \"\");\r\n    setContent(\"\");\r\n  };\r\n\r\n  const onSubmit = async (formValues: any) => {\r\n    if (postId) {\r\n      await instance\r\n        .post(\r\n          \"/posts/update\",\r\n          {\r\n            _id: postId,\r\n            content,\r\n            title: formValues.title,\r\n          },\r\n          {\r\n            headers: {\r\n              Authorization: `Bearer ${cookies.token}`,\r\n            },\r\n          }\r\n        )\r\n        .then((res) => {\r\n          if (res.status === 200) {\r\n            resetFields();\r\n            history.push(\"/admin/posts\");\r\n          }\r\n        });\r\n    } else {\r\n      await instance\r\n        .post(\r\n          \"/posts/insert\",\r\n          {\r\n            content,\r\n            title: formValues.title,\r\n            createdAt: moment().format(\"ll\"),\r\n            description: formValues.description,\r\n          },\r\n          {\r\n            headers: {\r\n              Authorization: `Bearer ${cookies.token}`,\r\n            },\r\n          }\r\n        )\r\n        .then((res) => {\r\n          if (res.status === 200) {\r\n            resetFields();\r\n            history.push(\"/admin/posts\");\r\n          }\r\n        });\r\n    }\r\n  };\r\n\r\n  return (\r\n    <form onSubmit={handleSubmit(onSubmit)}>\r\n      <input {...register(\"title\")} name=\"title\" placeholder=\"כותרת הפוסט\" />\r\n      <input\r\n        {...register(\"description\")}\r\n        name=\"description\"\r\n        placeholder=\"תיאור\"\r\n      />\r\n      <EditorWrapper>\r\n        <ReactQuill\r\n          theme=\"snow\"\r\n          value={content}\r\n          onChange={onChange}\r\n          modules={modules}\r\n        />\r\n      </EditorWrapper>\r\n\r\n      <button type=\"submit\">{postId ? \"עדכן\" : \"הוסף\"}</button>\r\n    </form>\r\n  );\r\n}\r\n\r\nexport default AddPost;\r\n\r\nconst EditorWrapper = styled.div`\r\n  .ql-syntax {\r\n    direction: ltr;\r\n  }\r\n`;\r\n\r\nconst modules = {\r\n  toolbar: [\r\n    [{ header: [1, 2, false] }],\r\n    [\"blockquote\", \"code-block\"],\r\n    [\"bold\", \"italic\", \"underline\", \"strike\", \"blockquote\"],\r\n    [\r\n      { list: \"ordered\" },\r\n      { list: \"bullet\" },\r\n      { indent: \"-1\" },\r\n      { indent: \"+1\" },\r\n    ],\r\n    [\"link\", \"image\", \"video\"],\r\n    [{ direction: \"rtl\" }],\r\n  ],\r\n};\r\n","import { useEffect, useState } from \"react\";\r\nimport instance from \"../../../api\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport { useCookies } from \"react-cookie\";\r\n\r\nfunction MyPosts() {\r\n  const [posts, setPosts] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const history = useHistory();\r\n  const [cookies] = useCookies();\r\n\r\n  useEffect(() => {\r\n    setLoading(true);\r\n    instance.get(\"/posts\").then((response) => {\r\n      setPosts(response.data);\r\n      setLoading(false);\r\n    });\r\n  }, []);\r\n\r\n  const handleRemovePost = async (idToRemove: string) => {\r\n    await instance\r\n      .post(\r\n        \"/posts/delete\",\r\n        {\r\n          _id: idToRemove,\r\n        },\r\n        {\r\n          headers: {\r\n            Authorization: `Bearer ${cookies.token}`,\r\n          },\r\n        }\r\n      )\r\n      .then((res) => {\r\n        if (res.status === 200) {\r\n          window.location.reload();\r\n        }\r\n      });\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      {posts.length > 0 ? posts.map((post: any) => {\r\n        return (\r\n          <div key={post._id}>\r\n            <p>{post.title}</p>\r\n            <p>{post.createdAt} נוצר ב-</p>\r\n            <button onClick={() => history.push(`/admin/${post._id}`)}>\r\n              עריכה\r\n            </button>\r\n            <button\r\n              onClick={() => {\r\n                handleRemovePost(post._id);\r\n              }}\r\n            >\r\n              מחיקה\r\n            </button>\r\n          </div>\r\n        );\r\n      }) : (\r\n        <div>\r\n          {loading ? <h1>Loading...</h1> : <h1>No posts</h1>}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default MyPosts;\r\n","import { useEffect } from \"react\";\r\nimport { useCookies } from \"react-cookie\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport AddPost from \"./add-post/AddPost\";\r\nimport MyPosts from \"./my-posts/MyPosts\";\r\nimport Login from \"./login/Login\";\r\nimport { useRouteMatch, Switch, Route } from \"react-router-dom\";\r\n\r\nfunction Admin() {\r\n  const { url } = useRouteMatch();\r\n  const [cookies] = useCookies();\r\n  const history = useHistory();\r\n\r\n  useEffect(() => {\r\n    if (!cookies.token) {\r\n      history.push(\"/admin/login\");\r\n    }\r\n  }, [cookies, history]);\r\n\r\n  return (\r\n    <div style={{ display: \"flex\" }}>\r\n      {history.location.pathname !== \"/admin/login\" && (\r\n        <nav\r\n          style={{\r\n            display: \"flex\",\r\n            flexDirection: \"column\",\r\n            alignItems: \"center\",\r\n            height: \"100vh\",\r\n            width: \"20rem\",\r\n            paddingTop: \"3rem\",\r\n          }}\r\n        >\r\n          <button onClick={() => history.push(`${url}/posts`)}>\r\n            המאמרים שלי\r\n          </button>\r\n          <button onClick={() => history.push(`${url}/posts/insert`)}>\r\n            הוסף מאמר חדש\r\n          </button>\r\n          <button onClick={() => history.push('/')}>\r\n            דף הבית\r\n          </button>\r\n        </nav>\r\n      )}\r\n\r\n      <Switch>\r\n        <Route exact path={`${url}/posts`}>\r\n          <MyPosts />\r\n        </Route>\r\n        <Route exact path={`${url}/login`}>\r\n          <Login />\r\n        </Route>\r\n        <Route exact path={`${url}/posts/insert`}>\r\n          <AddPost />\r\n        </Route>\r\n        <Route path={`${url}/:postId`}>\r\n          <AddPost />\r\n        </Route>\r\n      </Switch>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Admin;\r\n"],"sourceRoot":""}